<!DOCTYPE html><html class="no-js" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '///gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><link href="https:///css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta property="og:title" content="应用程序性能分析 - Unity 手册">
<title>应用程序性能分析 - Unity 手册</title>
<meta property="og:image" content="https://docs.unity3d.com/cn/2020.3/uploads/Main/profiler-build-settings.png">
<meta name="description" content="使用 Unity 性能分析器对应用程序进行性能分析时，可以通过三种主要方式记录数据：">
<meta property="og:description" content="使用 Unity 性能分析器对应用程序进行性能分析时，可以通过三种主要方式记录数据：">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="https://" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836"></script><script type="text/javascript">
        function OptanonWrapper() { }
    </script><script>
      var docs_type = 'Manual';
      var lang = 'cn';
      var page = 'profiler-profiling-applications';
      if(!page) page = 'index';
      var version = '2020.3';
      var docs_versions = [{version: '2022.1',version_string: '2022.1',supported: true},{version: '2021.3',version_string: '2021.3',supported: true},{version: '2021.2',version_string: '2021.2',supported: false},{version: '2021.1',version_string: '2021.1',supported: false},{version: '2020.3',version_string: '2020.3',supported: true},{version: '2020.2',version_string: '2020.2',supported: false},{version: '2020.1',version_string: '2020.1',supported: false},{version: '2019.4',version_string: '2019.4',supported: true},{version: '2019.3',version_string: '2019.3',supported: false},{version: '2019.2',version_string: '2019.2',supported: false},{version: '2019.1',version_string: '2019.1',supported: false},{version: '2018.4',version_string: '2018.4',supported: false},{version: '2018.3',version_string: '2018.3',supported: false},{version: '2018.2',version_string: '2018.2',supported: false},{version: '2018.1',version_string: '2018.1',supported: false},{version: '2017.4',version_string: '2017.4',supported: false},{version: '2017.3',version_string: '2017.3',supported: false},{version: '2017.2',version_string: '2017.2',supported: false},{version: '2017.1',version_string: '2017.1',supported: false},{version: '5.6',version_string: '560',supported: false},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
<link rel="canonical" href="https://docs.unity3d.com/cn/2020.3/Manual/profiler-profiling-applications.html">
<link rel="alternate" href="https://docs.unity3d.com/en/2020.3/Manual/profiler-profiling-applications.html" hreflang="en">
<link rel="alternate" href="https://docs.unity3d.com/cn/2020.3/Manual/profiler-profiling-applications.html" hreflang="zh">
<link rel="alternate" href="https://docs.unity3d.com/ja/2020.3/Manual/profiler-profiling-applications.html" hreflang="ja">
<link rel="alternate" href="https://docs.unity3d.com/es/2020.3/Manual/profiler-profiling-applications.html" hreflang="es">
<link rel="alternate" href="https://docs.unity3d.com/kr/2020.3/Manual/profiler-profiling-applications.html" hreflang="ko">
<link rel="alternate" href="https://docs.unity3d.com/ru/2020.3/Manual/profiler-profiling-applications.html" hreflang="ru">
<link rel="alternate" href="https://docs.unity3d.com/2020.3/Documentation/Manual/profiler-profiling-applications.html" hreflang="x-default">
</head>
<body>
<noscript><iframe src="///ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="./index.html"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="搜索手册..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2020.3</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2022.1" href="/cn/2022.1/Manual/profiler-profiling-applications.html">2022.1</a></li>
<li class="supported"><a class="docs_version_url_2021.3" href="/cn/2021.3/Manual/profiler-profiling-applications.html">2021.3</a></li>
<li class=""><a class="docs_version_url_2021.2" href="/cn/2021.2/Manual/profiler-profiling-applications.html">2021.2</a></li>
<li class=""><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/profiler-profiling-applications.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/profiler-profiling-applications.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/profiler-profiling-applications.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/profiler-profiling-applications.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/profiler-profiling-applications.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/profiler-profiling-applications.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/profiler-profiling-applications.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/profiler-profiling-applications.html">2019.1</a></li>
<li class=""><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/profiler-profiling-applications.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/profiler-profiling-applications.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/profiler-profiling-applications.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/profiler-profiling-applications.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/profiler-profiling-applications.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/profiler-profiling-applications.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/profiler-profiling-applications.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/profiler-profiling-applications.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/profiler-profiling-applications.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">语言:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2020.3/Documentation/Manual/profiler-profiling-applications.html">English</a></li>
<li><a data-lang="cn" href="/cn/2020.3/Manual/profiler-profiling-applications.html">中文</a></li>
<li><a data-lang="ja" href="/ja/2020.3/Manual/profiler-profiling-applications.html">日本語</a></li>
<li><a data-lang="es" href="/es/2020.3/Manual/profiler-profiling-applications.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2020.3/Manual/profiler-profiling-applications.html">한국어</a></li>
<li><a data-lang="ru" href="/ru/2020.3/Manual/profiler-profiling-applications.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>手册</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2020.3</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2022.1" href="/cn/2022.1/Manual/profiler-profiling-applications.html">2022.1</a></li>
<li class="supported"><a class="docs_version_url_2021.3" href="/cn/2021.3/Manual/profiler-profiling-applications.html">2021.3</a></li>
<li class=""><a class="docs_version_url_2021.2" href="/cn/2021.2/Manual/profiler-profiling-applications.html">2021.2</a></li>
<li class=""><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/profiler-profiling-applications.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/profiler-profiling-applications.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/profiler-profiling-applications.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/profiler-profiling-applications.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/profiler-profiling-applications.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/profiler-profiling-applications.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/profiler-profiling-applications.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/profiler-profiling-applications.html">2019.1</a></li>
<li class=""><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/profiler-profiling-applications.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/profiler-profiling-applications.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/profiler-profiling-applications.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/profiler-profiling-applications.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/profiler-profiling-applications.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/profiler-profiling-applications.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/profiler-profiling-applications.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/profiler-profiling-applications.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/profiler-profiling-applications.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity 用户手册 2020.3 (LTS)</a></li>
<li><a href="UnityOverview.html">在 Unity 中操作</a></li>
<li><a href="analysis.html">分析</a></li>
<li><a href="Profiler.html">性能分析器概述</a></li>
<li>应用程序性能分析</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="Profiler.html"></a></span><div class="tip">性能分析器概述</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="profiler-markers.html"></a></span><div class="tip">常见性能分析器标记</div>
</div>
</div></div>
<h1>应用程序性能分析</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>使用 <a href="Profiler.html">Unity 性能分析器</a>对应用程序进行性能分析时，可以通过三种主要方式记录数据：</p>

<ul>
<li>在目标平台上的播放器中对应用程序进行性能分析</li>
<li>在 Unity 编辑器中以运行模式对应用程序进行性能分析</li>
<li>对 Unity 编辑器进行性能分析</li>
</ul>

<p>获得有关应用程序的准确时序的最佳方法是在打算发布它的终端平台上对它进行性能分析。这样可提供有关影响应用程序性能的因素的准确时序。</p>

<p>However, it can be time-consuming to build your application every time you would like to improve elements of its performance. To quickly assess the performance of your application you can profile it directly in Play mode in the Editor. Profiling in Play mode doesn’t give you an accurate reflection of what the performance of your application looks like on a real device, but it’s a useful tool to quickly check to see if the changes you make improve your application’s performance, after initially profiling on the end platform.</p>

<p>Unity 编辑器可能会影响应用程序的性能，因为它在运行模式下运行时使用与应用程序相同的资源，因此还可以单独对编辑器进行性能分析以确定它使用的资源。如果应用程序仅设计为在运行模式下工作（例如用于电影制作），这会特别有用。</p>

<h2>在目标平台上对应用程序进行性能分析</h2>

<p>To profile your application on its target release platform, connect the target device to your network or directly to your computer via cable. You can also connect to a device via IP address. You can only profile your application as a <strong>Development Build</strong>. To set this up, go to <strong>Build Settings</strong> (menu: <strong>File</strong> &gt; <strong>Build Settings</strong>) and select your application’s target platform. Enable the <strong>Development Build</strong> setting. When you enable this setting, two settings related to the Profiler become available: <strong>Autoconnect Profiler</strong> and <strong>Deep Profiling Support</strong>.</p>

<figure>
<img src="../uploads/Main/profiler-build-settings.png" alt="Build Settings 窗口，已启用性能分析选项">
<figcaption>Build Settings 窗口，已启用性能分析选项</figcaption>
</figure>

<p>When you enable the <strong>Autoconnect <span class="no tooltip">Profiler</span></strong> setting, the Unity Editor bakes its IP address into the built Player during the build process. When you start the Player, it attempts to connect to the Profiler in the Editor located at the baked IP address.</p>

<p>If you also enable the <strong>Deep Profiling Support</strong> setting, Unity performs <a href="ProfilerWindow.html#deep-profiling">Deep Profiling</a> when the built Player starts, which means that the Profiler profiles every part of your code, and not just code timings explicitly wrapped in <a href="../ScriptReference/Unity.Profiling.ProfilerMarker.html">ProfilerMarkers</a>. This is useful to get Deep Profiling information on your application’s start up times, however, this adds a small amount of overhead to your build.</p>

<h3>在 Profiler 窗口中连接到播放器</h3>

<p>If you don’t enable the <strong>Autoconnect Profiler</strong> setting in the Build Settings, you can manually connect to a platform running your application. While your application is running in a player, the player appears in the <strong>Attach to Player</strong> drop-down of the Profiler window. The <strong>Attach to Player</strong> drop-down shows all Unity Players running on your local network. You can identify these Players by player type and the hostname that’s running the player (for example, “iPhonePlayer (Toms iPhone)”).</p>

<p>还可以通过 IP 地址远程连接到播放器。为此，请选择 <strong>Attach to Player</strong> 菜单，然后在下拉选单中选择 <strong>&lt;Enter IP&gt;</strong>。一个对话框会出现，可以在其中键入要连接的播放器的 IP 地址和（可选）端口。</p>

<figure>
<img src="../uploads/Main/profiler-player-dropdown.png" alt="Attach to Player 下拉选单">
<figcaption>Attach to Player 下拉选单</figcaption>
</figure>

<p>要开始收集有关应用程序的性能分析信息，请从下拉菜单中选择播放器，然后单击 <strong>Record</strong>。要在应用程序运行时持续收集数据，请启用 Player Settings 中的 <strong>Run In Background</strong> 设置（菜单：<strong>Edit</strong> &gt; <strong>Project Settings</strong> &gt; <strong>Player</strong> &gt; <strong>Resolution and Presentation</strong>）。启用此设置后，即使让应用程序在后台运行，性能分析器也会收集数据。如果禁用此设置，性能分析器仅在应用程序在活动窗口中运行时才收集数据。</p>

<h3>平台特定性能分析指南</h3>

<p>将不同平台连接到 Unity 性能分析器时，它们会具有不同的行为方式。以下部分提供有关每个平台的一些常见行为的指导：</p>

<p><a name="profiling-webgl"></a></p>

<h4>WebGL</h4>

<p>You can use the Unity Profiler in WebGL, but you can’t attach to a running player built with WebGL via the Editor. This is because WebGL uses WebSockets for communication, which doesn’t allow incoming connections on the browser side. To attach to a running player, you need to enable the <strong>Autoconnect Profiler</strong> checkbox in <strong>Build Settings</strong> (menu: <strong>File</strong> &gt; <strong>Build Settings</strong>). Unity can’t profile draw calls for WebGL.</p>

<h4>移动设备上的性能分析</h4>

<p>iOS 和 Android 设备均支持通过网络进行远程性能分析。如果使用了防火墙，请在防火墙的出站规则中开放端口 54998 至 55511。这些是 Unity 用于远程性能分析的端口。</p>

<p>Sometimes, when you set up remote profiling, the Unity Editor might not autoconnect to the device. If this happens, you can initiate the Profiler connection manually. To do this, select the <strong>Attach to Player</strong> drop-down menu in the Profiler window and choose the appropriate device.</p>

<p>也可以将目标设备直接插入计算机以避免网络或连接问题。</p>

<p><a name="profiling-ios"></a></p>

<h5>iOS 远程性能分析</h5>

<p>要对 iOS 设备启用远程性能分析，请遵循以下步骤：</p>

<p>1.将 iOS 设备连接到 WiFi 网络。性能分析器会使用本地 WiFi 网络将性能分析数据从设备发送到 Unity Editor。
1.通过线缆将设备连接到计算机。打开 Build Settings（菜单：<strong>File</strong> &gt; <strong>Build Settings</strong>），选中 <strong>Development Build</strong> 和 <strong>Autoconnect Profiler</strong> 复选框，然后选择 <strong>Build &amp; Run</strong>。
1.应用程序在设备上启动时，请在 Unity 编辑器中打开 Profiler 窗口（菜单：<strong>Window</strong> &gt; <strong>Analysis</strong> &gt; <strong>Profiler</strong>）。</p>

<p><a name="profiling-android"></a></p>

<h5>Android 远程性能分析</h5>

<p>Android 设备支持两种远程性能分析方法：通过 WiFi 或通过 <a href="https://developer.android.com/studio/command-line/adb">Android Debug Bridge (adb)</a>。</p>

<p>要进行 WiFi 性能分析，请遵循以下步骤：</p>

<p>1.在 Android 设备上禁用移动数据。
1.将 Android 设备连接到 WiFi 网络。性能分析器会使用本地 WiFi 网络将性能分析数据从设备发送到 Unity Editor。
1.通过线缆将设备连接到计算机。打开 Build Settings（菜单：<strong>File</strong> &gt; <strong>Build Settings</strong>），选中 <strong>Development Build</strong> 和 <strong>Autoconnect Profiler</strong> 复选框，然后选择 <strong>Build &amp; Run</strong>。
1.应用程序在设备上启动时，请在 Unity 编辑器中打开 Profiler 窗口（菜单：<strong>Window</strong> &gt; <strong>Analysis</strong> &gt; <strong>Profiler</strong>）。</p>

<p><strong>Note</strong>: The Android device and host computer that’s running the Unity Editor must both be on the same subnet for device detection to work.</p>

<p>要进行 Android Debug Bridge (adb) 性能分析，请遵循以下步骤：</p>

<p>1.确保设备处于<strong>开发模式</strong>并启用 <strong>USB debugging</strong> 设置
1.通过线缆将设备连接到计算机，并确保在 adb 设备列表中显示了该设备。
1.打开 Build Settings（菜单：<strong>File</strong> &gt; <strong>Build Settings</strong>），选中 <strong>Development Build</strong> 复选框，然后选择 <strong>Build &amp; Run</strong>。
1.应用程序在设备上启动时，请在 Unity 编辑器中打开 Profiler 窗口（菜单：<strong>Window</strong> &gt; <strong>Analysis</strong> &gt; <strong>Profiler</strong>）。
1.从 <strong>Attach to Player</strong> 下拉菜单中，选择 <strong>AndroidProfiler(ADB@127.0.0.1:34999)</strong>。仅当所选目标为 Android 时，下拉菜单中才会显示该条目。</p>

<p>选择 <strong>Build &amp; Run</strong> 时，Unity Editor 会自动为应用程序创建 adb 隧道。如果要对另一应用程序进行性能分析，或者重新启动 adb 服务器，则需要手动配置此隧道。为此，请打开终端窗口或命令提示符窗口，并输入以下内容：</p>

<ul>
<li>
<p>通过 USB 线缆建立编辑器到 Android 的连接时需要</p>

<p><code>adb forward tcp:34999 localabstract:Unity-{insert bundle identifier here}</code></p>
</li>
<li>
<p>通过 USB 线缆建立 Android 到编辑器的连接时需要</p>

<p><code>adb reverse tcp:34998 tcp:34999</code></p>
</li>
</ul>

<p>要将深度性能分析用于 Android 构建，必须启用 <a href="class-PlayerSettingsAndroid.html">Android Player Settings</a> 中的 Mono Scripting Backend 设置（菜单：<strong>Edit</strong> &gt; <strong>Project Settings</strong> &gt; <strong>Player</strong> &gt; <strong>Android</strong> &gt; <strong>Other Settings</strong>），然后输入以下内容以便通过 adb 命令来启动游戏：</p>

<pre><code>~$ adb shell am start -n {insert bundle identifier here}/com.unity3d.player.UnityPlayerActivity -e 'unity' '-deepprofiling'
</code></pre>

<h3>Android Chrome OS 远程性能分析</h3>

<p>Unity can’t automatically discover Chrome OS devices. To initiate a connection, connect to the device through Android Debug Bridge (adb) by its IP address and then select <code>&lt;Enter IP&gt;</code> from the <strong>Attach to Player</strong> drop-down menu and enter the device’s IP address. Once you have connected, you can profile your application as usual.</p>

<h2>在 Unity 编辑器中进行性能分析</h2>

<p>When you use the Profiler window to run and profile your application in the Editor, the results are only an approximation of your application’s behavior when the target platform runs it. This is because Play mode runs in the same process as the Editor, so you can’t fully isolate your application’s CPU, GPU, and memory usage from the Unity Editor’s usage. This skews the resulting profiling data.</p>

<p>要获得更好的性能分析结果，应该始终在目标设备上对应用程序进行性能分析，并且仅在编辑器中进行性能分析以快速迭代在设备上已确定的问题。</p>

<p>还可以在运行模式下进行性能分析或是对编辑器进行性能分析以确定与应用程序性能无关的问题，例如较长的加载时间或无响应的编辑器是否会减慢迭代时间，或者应用程序是否在运行模式下性能不佳。</p>

<p>Whenever you profile in the Editor, you should make sure that you open Play mode in maximized view, and reduce the amount of open Editor windows. This ensures that other Editor windows don’t use up time on the render thread and GPU, and therefore affect the performance data. When Play mode is in a maximized view it runs your application at a resolution closer to that of your target device, which directly affects performance issues such as those related to fill rate.</p>

<h3>在运行模式下进行性能分析</h3>

<p>The Profiler’s default target is Play mode, which records activities when the Editor is running Play mode. Play mode profiling is useful to test out quick changes without having to rebuild a player, but you shouldn’t use it as a replacement for validating builds on your application’s target platform and devices. This is because Play mode runs in the same application and main thread as the Editor, which means that when you profile in Play mode, the Editor’s systems such as the UI, Inspectors, Scene View rendering, and asset management affect the performance and memory profiling measurements of your application.</p>

<p>要在运行模式下有效地进行性能分析，应该定期构建应用程序并将它们部署到一系列目标设备（高规格和低规格设备），并在这些设备上对应用程序进行测试和性能分析。如果在这些设备上发现应用程序方面的性能问题，请缩小最需要关注的区域。</p>

<p>随后可以在运行模式下对应用程序进行性能分析，并快速迭代对应用程序进行的任何更改。可以使用通过在目标设备上对应用程序进行性能分析而获得的信息来确定在运行模式下对应用程序进行性能分析后是否存在任何类似行为。随后可以更改应用程序，并再次在运行模式下进行性能分析以快速查看更改所产生的效果。一旦对更改感到满意，请再次构建应用程序并部署到目标设备以验证更改。</p>

<h4>PlayerLoop 和 EditorLoop 样本</h4>

<p>为了减少编辑器在运行运行模式时创建的性能分析数据中的噪声和误导性测量数量，CPU 和 GPU 性能分析器模块将其时序拆分为在 <strong>PlayerLoop</strong> 和 <strong>EditorLoop</strong> 中发生的时序。Unity 会向这些类型的性能分析器样本分配 <a href="profiler-markers.html">PlayerLoop 和 EditorLoop 标记</a>。</p>

<p>当性能分析器以运行模式为目标时，它只收集发生在 PlayerLoop 内部发生的时序样本。</p>

<p>在 <a href="ProfilerCPU.html#charts">CPU 性能分析器模块图表</a>中，Unity 将所有 EditorLoop 样本都分类为 <strong>Others</strong>。因此，EditorLoop 样本是该类别的最大贡献者。如果想了解编辑器在这段时间内的操作，并且还想获得有关 <strong>Others</strong> 类别的其他贡献者的更详细细分，请将性能分析器目标更改为编辑器。</p>

<p><strong>Important:</strong> If you use <a href="ProfilerWindow.html#deep-profiling">Deep Profiling</a>, and target Play mode, it has a performance impact on every function call that happens in both PlayerLoop and EditorLoop. This is because Deep Profiling hooks into the beginning and end of any scripting method call on domain reload and it doesn’t detect which parts are never called from the PlayerLoop. The method calls that happen in the EditorLoop don’t incur the full overhead of creating a sample, but they still check if they should emit one, which causes a smaller but still present overhead.</p>

<h3>对编辑器进行性能分析</h3>

<p>将性能分析器的目标更改为<strong>编辑器</strong>时，之前隐藏在 EditorLoop 标记下的所有样本都会归类到其各自的类别中。这意味着 CPU 性能分析器模块详细信息面板及其图表中的信息会显著更改。</p>

<p>要对编辑器的启动时间进行性能分析，请使用命令行选项 <code>-profiler-enable</code> 启动编辑器。</p>

<p>要减少 Profiler 窗口对编辑器性能的影响，可以使用<a href="ProfilerWindow.html#standalone">独立性能分析器</a>（它会在自己的进程中打开 Profiler 窗口）。如果选择编辑器作为性能分析目标，或是<a href="ProfilerWindow.html#deep-profiling">对应用程序进行深度性能分析</a>，那么这会尤其有用，因为 Profiler 窗口本身通常使用可能会使性能数据出现偏差的资源。</p>

<h2>对应用程序进行性能分析的最佳实践</h2>

<p>When you profile your application, there are a few things that you can do to ensure consistency across profiling sessions, and to make sure that the processes that Unity uses doesn’t affect your profiling data:</p>

<ul>
<li>只添加与要调查到 Profiler 窗口的区域相关的<a href="ProfilerWindow.html#modules">性能分析器模块</a>。要向性能分析器添加和移除模块，请选择 Profiler 窗口左上角的下拉选单。</li>
<li>避免使用深度性能分析，因为它会在使用时产生较高开销。如果要查看有关带有标记（如 GC.Alloc 或 JobFence.Complete）的样本的更多详细信息，请导航到 Profiler 窗口工具栏并启用 <a href="ProfilerWindow.html#controls">Call Stacks 设置</a>。这可提供样本的完整调用栈，其中会提供所需信息，而不会产生深度性能分析的开销。</li>
<li>Disable the Live setting if you don’t need to see the Hierarchy or Timeline view updating as the Profiler collects data. Stop recording to see the data update to the window.</li>
<li>使用 F9 快捷键启用或禁用性能分析器。可以使用此快捷键捕获性能数据，而无需打开 Profiler 窗口。如果打开了独立性能分析器，则使用此快捷键会在此窗口中开始记录。</li>
</ul>

<hr>

<ul>
<li><span class="page-history">在 <a href="https://docs.unity3d.com/Manual/30_search.html?q=newin20193">2019.3</a> 中添加了 Deep Profiling Support <span class="search-words">NewIn20193</span></span></li>
</ul>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="Profiler.html"></a></span><div class="tip">性能分析器概述</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="profiler-markers.html"></a></span><div class="tip">常见性能分析器标记</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">版权所有 © 2021 Unity Technologies. Publication 2020.3</div>
<div class="menu">
<a href="https://learn.unity.com/">教程</a><a href="https://answers.unity3d.com">社区答案</a><a href="https://support.unity3d.com/hc/en-us">知识库</a><a href="https://forum.unity3d.com">论坛</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
